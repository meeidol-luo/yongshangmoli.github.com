<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta charset="utf-8">
        <title>腾爱医生微信网站，与患者沟通自如，强大插件自由定义，数据分析简单明了。</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" >
        
        <link href="http://doctor.qq.com/mp/public/admin/images/favicon.ico" rel="bookmark"  type="image/x-icon"  />
		<link href="http://doctor.qq.com/mp/public/admin/images/favicon.ico" mce_href="favicon.ico" rel="shortcut icon" type="image/x-icon" /> 
        
        <link rel="stylesheet" href="http://s.pc.qq.com/byb/admin/animate/animate.min.css">
        <link type="text/css" rel="stylesheet" href="css/style.css" />
        <script type="text/javascript" src="http://s.pc.qq.com/byb/jquery/jquery-1.11.3.min.js"></script>
        <script src="js/jquery-ui.min.js" type="text/javascript" ></script>
        <meta name="Description" content="腾爱医生为医生群体打造属于自己的公众号品牌，一分钟搞定微信网站，用自己的公众号与患者沟通，强大的插件自由定义，数据想看就看" />
		<meta name="Keywords" content="腾爱医生,腾爱医生公众号管理,腾爱医生微信网站，腾讯医生插件，腾讯医生数据" />
    </head>
    <body>    
        
        <div class="download-layer">
            <div class="fline">
                <p>使用微信扫码，手机直接下载安装</p>
            </div>
            <div class="qrcode">
                <img alt="" src="http://s.pc.qq.com/byb/WUfb6bCSvllXjeEiDOUOCTC7qMZ8ZH1Dwg1N6VIUh2i2Ja0-1Cpkt81PVmf4nHHQ.png">
            </div>
        </div>        
        <div class="container-fluid">
            <!-- layout header -->
            <div class="header">
                <div class="header-content">
                    <div class="logo" ><a hidefocus="true" href="/mp/admin/Dashboard"></a></div>
                    <div class="mp-info">
                        <div class="mp" id="mpName">
                            <div class="scan-download animated fadeIn">
                                <span class="icon"></span>
                                <p class="">手机端</p>
                            </div>
                        
                            <div id="loginHeadImg" class="mp-logo" style=""></div>
                            <div id="loginNickname" class="mp-name" style=""></div>
                            <div class="logout">
                                <a onclick="return window.confirm('确定退出？');" href="/mp/admin/Login/out" style="color: #FF0000">退出</a>
                            </div>
                    </div>
                    </div>
                </div>
            </div>
            
            <div class="main animated fadeIn">
                <div class="main-content def-body">
                    <div class="def-step">
                        <span id="go_index"><a href="javascript:void(0);">腾爱医生<i style="float:none;margin-top: -4px;" class="defbd-aglr "></i></a></span>
                        <span>团队主页</span>
                    </div>
                    <div>
                        <div class="defbd-left">
                            <div class="main-body">
                                <div class="top"></div>
                                <ul id="preview_team">
                                    <li id="teamInfo_prvw" class="active" style="position:relative;border:none;">
                                        <img id="teambg_prvw" class="banner-img" src="images/place.png" alt="团队主页背景">
                                        <div id="teamcnt_prvw" class="banner float-clear shadow">
                                           <!--  <a class="edit" href="javascript:void(0);" style="display: none;"><i></i>编辑</a> -->
                                            <div class="team-icon">
                                                <img src="images/team-icon.png" alt="团队图标">
                                            </div>
                                            <h3 id="team_name" class="trunc-text">团队名称</h3>
                                            <div class="intro-wrp-fix">
                                                <p id="team_intro">团队介绍</p>
                                            </div>
                                            <div id="bottom_hide" style="display:none;" class="my-text-center"><span id="ov_rotate" class="defbd-aglt"></span></div>
                                        </div>
                                    </li>
                                    <li id="teamDct_prvw">
                                        <a class="add" href="javascript:void(0);">
                                            <div class="addwrp">
                                                <h3><span class="add-icon">+</span>选择医生</h3>
                                            </div>
                                        </a> 
                                        <!-- <div class="prew-title">
                                            <h4><span class="left"></span>医生<span class="defbd-aglr"></span><span class="count">&nbsp;&nbsp;4</span></h4>
                                        </div>
                                        <div class="prew-ul">
                                            <ul id="doctor_prev">
                                                <li>
                                                    <img class="left" src="images/article-img.jpg" alt="医生头像">
                                                    <div class="detail">
                                                        <h3>裴医生</h3>
                                                        <h4>原深圳市儿童医院副主任</h4>
                                                        <p>儿科硕士</p>
                                                        <dl class="tag">
                                                            <dt>喉软化</dt>
                                                            <dt>腺样体肥大</dt>
                                                            <dt>扁桃体炎</dt>
                                                        </dl>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div> -->
                                    </li>
                                    <li id="teamEsy_prvw">
                                        <a class="add" href="javascript:void(0);">
                                            <div class="addwrp">
                                                <h3><span class="add-icon">+</span>选择文章</h3>
                                            </div>
                                        </a>
                                        <!-- <div class="prew-title">
                                            <h4><span class="left"></span>文章<span class="more">&nbsp;&nbsp;></span><span class="count">&nbsp;&nbsp;13</span></h4>
                                        </div>
                                        <div class="prew-ul">
                                            <ul id="essay_prev">
                                                <li>
                                                    <img class="left" src="images/article-img.jpg" alt="文章缩略图">
                                                    <div class="detail">
                                                        <h4 class="trunc-text">孩子需要吃打虫药吗？</h4>
                                                        <p class="artcl">很多父母可能都记得小时候吃宝塔糖的事，宝塔糖虽然叫糖，但实际是一种...</p>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div> -->
                                    </li>
                                    <li id="teamCtat_prvw">
                                       <a class="add" href="javascript:void(0);">
                                          <div class="addwrp">
                                              <h3><span class="add-icon">+</span>团队联系方式</h3>
                                          </div>
                                      </a>
                                      <!--  <div id="contact_prev" class="prew-title">
                                          <h4><span class="left"></span>联系方式</h4>
                                       </div>
                                       <div class="prew-pd">
                                           <div class="prew-code">
                                              <img src="images/article-img.jpg" alt="医疗团队二维码">
                                           </div>
                                           <p class="prew-toscan">长按识别关注我们</p>
                                           <p class="prew-addr">地址：深圳市福田区侨香路岭南大厦319B</p>
                                           <p class="prew-phone">电话：0755-83661922</p>
                                       </div> -->
                                    </li>
                                </ul>
                            </div>
                            <div id="pub_prew" class="btn">
                                <div class="btn-hlt"><a href="javascript:void(0)">发布</a></div>
                                <div class="btn-nrm"><a href="javascript:void(0)">预览</a></div>
                            </div>
                        </div>
                        <div id="team_edit" class="defbd-right">
                            <h4>主页LOGO</h4>
                            <div class="icon-area">
                                <div class="img-prvw"></div>
                                <div class="img-upload">
                                    <div class="upload">
                                        <a href="javascript:void(0)">
                                            上传<input id="team_logo" class="file" type="file">
                                        </a>
                                    </div>
                                    <p>支持JPG，146X146像素效果最佳</p>
                                </div>
                            </div>
                            <h4>背景图</h4>
                            <ul id="bg_choose" class="banner-bg">
                                <li><img src="images/def-bg1.jpg" alt="背景图" /><div class="choose"></div></li>
                                <li><img src="images/def-bg2.jpg" alt="背景图" /><div class="choose"></div></li>
                                <li><img src="images/def-bg3.jpg" alt="背景图" /><div class="choose"></div></li>
                                <li><img src="images/def-bg4.jpg" alt="背景图" /><div class="choose"></div></li>
                            </ul>
                            <label><h4>名称</h4><input id="in_team_name" type="text" placeholder="腾爱医生团队"></label>
                            <label>
                                <h4>介绍</h4>
                                <textarea id="in_team_intro" placeholder="腾爱医生团队具备专业化的医师，作为国内外知名的儿科专家，联合了新生儿，儿童保健，呼吸，消化，内分泌，儿童心理等"></textarea>
                            </label>
                            <p class="tip">还能输入200字</p>
                            <div class="btn-store"><a id="team_store" href="javascript:void(0)">保存</a></div>
                        </div>
                        <!-- 医生列表 -->
                        <div id="doctor_edit" class="defbd-right"  style="display:none;">
                            <div id="index_dlist" class="defdl-wrp">
                                <p class="defdl-title">主页首页医生&nbsp;•&nbsp;<span id="sltd_doctors_count">0</span></p>
                                <ul id="sltd_doctors" class="ul-dct">
                                </ul>
                            </div>
                            <div id="sum_dlist" class="defdl-wrp">
                                <p class="defdl-title">勾选或者拖动医生&nbsp;•&nbsp;<span id="all_doctors_count">0</span></p>
                                <ul id="all_doctors" class="ul-dct">
                                  <!--  <li value="0">
                                      <img class="left" src="images/article-img.jpg" alt="医生头像">
                                      <div class="detail">
                                          <h3>裴医生</h3>
                                          <h4 class="trunc-text">原深圳市儿童医院副主任</h4>
                                          <p class="trunc-text">儿科硕士</p>
                                      </div>
                                      <div class="hdl-btn-wrp">
                                           <i class="delete"><a href="javascript:void(0);">删除</a></i><i class="one-up"><a href="javascript:void(0);">上移</a></i><i class="one-down"><a href="javascript:void(0);">下移</a></i>
                                      </div>
                                      <div class="hdl-btn-addw">
                                          <i class="tomain"><a href="javascript:void(0);">主页</a></i>
                                          <i class="add"><a href="javascript:void(0);">添加</a></i>
                                      </div>
                                  </li>
                                  <li value="1">
                                      <img class="left" src="images/article-img.jpg" alt="医生头像">
                                      <div class="detail">
                                          <h3>生</h3>
                                          <h4 class="trunc-text">原深圳市儿童医院副主任</h4>
                                          <p class="trunc-text">儿科硕士</p>
                                      </div>
                                      <div class="hdl-btn-wrp">
                                           <i class="delete"><a href="javascript:void(0);">删除</a></i><i class="one-up"><a href="javascript:void(0);">上移</a></i><i class="one-down"><a href="javascript:void(0);">下移</a></i>
                                      </div>
                                      <div class="hdl-btn-addw">
                                          <i class="tomain"><a href="javascript:void(0);">主页</a></i>
                                          <i class="add"><a href="javascript:void(0);">添加</a></i>
                                      </div>
                                  </li>
                                  <li value="2">
                                      <img class="left" src="images/article-img.jpg" alt="医生头像">
                                      <div class="detail">
                                          <h3>医生</h3>
                                          <h4 class="trunc-text">原深圳市儿童医院副主任</h4>
                                          <p class="trunc-text">儿科硕士</p>
                                      </div>
                                      <div class="hdl-btn-wrp">
                                           <i class="delete"><a href="javascript:void(0);">删除</a></i><i class="one-up"><a href="javascript:void(0);">上移</a></i><i class="one-down"><a href="javascript:void(0);">下移</a></i>
                                      </div>
                                      <div class="hdl-btn-addw">
                                          <i class="tomain"><a href="javascript:void(0);">主页</a></i>
                                          <i class="add"><a href="javascript:void(0);">添加</a></i>
                                      </div>
                                  </li>
                                  <li value="1">
                                      <img class="left" src="images/article-img.jpg" alt="医生头像">
                                      <div class="detail">
                                          <h3>生</h3>
                                          <h4 class="trunc-text">原深圳市儿童医院副主任</h4>
                                          <p class="trunc-text">儿科硕士</p>
                                      </div>
                                      <div class="hdl-btn-wrp">
                                           <i class="delete"><a href="javascript:void(0);">删除</a></i><i class="one-up"><a href="javascript:void(0);">上移</a></i><i class="one-down"><a href="javascript:void(0);">下移</a></i>
                                      </div>
                                      <div class="hdl-btn-addw">
                                          <i class="tomain"><a href="javascript:void(0);">主页</a></i>
                                          <i class="add"><a href="javascript:void(0);">添加</a></i>
                                      </div>
                                  </li>
                                  <li value="2">
                                      <img class="left" src="images/article-img.jpg" alt="医生头像">
                                      <div class="detail">
                                          <h3>医生</h3>
                                          <h4 class="trunc-text">原深圳市儿童医院副主任</h4>
                                          <p class="trunc-text">儿科硕士</p>
                                      </div>
                                      <div class="hdl-btn-wrp">
                                           <i class="delete"><a href="javascript:void(0);">删除</a></i><i class="one-up"><a href="javascript:void(0);">上移</a></i><i class="one-down"><a href="javascript:void(0);">下移</a></i>
                                      </div>
                                      <div class="hdl-btn-addw">
                                          <i class="tomain"><a href="javascript:void(0);">主页</a></i>
                                          <i class="add"><a href="javascript:void(0);">添加</a></i>
                                      </div>
                                  </li>
                                   -->
                                </ul>
                            </div>
                            <div class="btn-store more-mt"><a id="doctor_store" href="javascript:void(0)">保存</a></div>
                        </div>
                        <!-- 文章列表 -->
                        <div id="essay_edit" class="defbd-right"  style="display:none;">
                            <div id="index_elist" class="defdl-wrp defey-wrp">
                                <p class="defdl-title">主页首页文章&nbsp;•&nbsp;<span id="sltd_essay_count">0</span></p>
                                <ul id="sltd_essay" class="ul-esy">
                                </ul>
                            </div>
                            <div id="sum_elist" class="defdl-wrp defey-wrp">
                                <p class="defdl-title">勾选或者拖动文章&nbsp;•&nbsp;<span id="all_essay_count">0</span></p>
                                <ul id="all_essay" class="ul-esy">
                                    <!-- <li value="1">
                                        <img class="left" src="images/article-img.jpg" alt="医生头像">
                                        <div class="detail">
                                            <h4 class="trunc-text">博德</h4>
                                            <p class="trunc-text">5月28日在松禾资本多功能室... </p>
                                        </div>
                                        <div class="hdl-btn-wrp">
                                             <i class="delete"><a href="javascript:void(0);">删除</a></i><i class="one-up"><a href="javascript:void(0);">上移</a></i><i class="one-down"><a href="javascript:void(0);">下移</a></i>
                                        </div>
                                        <div class="hdl-btn-addw">
                                            <i class="tomain"><a href="javascript:void(0);">主页</a></i>
                                            <i class="add"><a href="javascript:void(0);">添加</a></i>
                                        </div>
                                    </li>
                                    <li value="2">
                                        <img class="left" src="images/article-img.jpg" alt="医生头像">
                                        <div class="detail">
                                            <h4 class="trunc-text">松禾</h4>
                                            <p class="trunc-text">5月28日在松禾资本多功能室... </p>
                                        </div>
                                        <div class="hdl-btn-wrp">
                                             <i class="delete"><a href="javascript:void(0);">删除</a></i><i class="one-up"><a href="javascript:void(0);">上移</a></i><i class="one-down"><a href="javascript:void(0);">下移</a></i>
                                        </div>
                                        <div class="hdl-btn-addw">
                                            <i class="tomain"><a href="javascript:void(0);">主页</a></i>
                                            <i class="add"><a href="javascript:void(0);">添加</a></i>
                                        </div>
                                    </li> -->
                                </ul>
                            </div>
                            <div class="btn-store more-mt"><a id="essay_store" href="javascript:void(0)">保存</a></div>
                        </div>
                        <!-- 联系方式 -->
                        <div id="contact_edit" class="defbd-right"  style="display:none;">
                            <div style="height:606px;">
                                <label>
                                    <h4>联系地址</h4>
                                    <input type="text" id="contact_addr">
                                </label>
                                 <label>
                                    <h4>联系电话</h4>
                                    <input type="number" id="contact_phone">
                                </label>
                                <label id="add_code">
                                    <h4><span id="code_record" class="choose"></span>公众号二维码</h4>
                                    <input type="checkbox" class="rdo-hide" id="contact_code">
                                    <div class="team-scan">
                                        <img src="images/for-scan.png" alt="二维码">
                                    </div>
                                </label>
                            </div>
                            <div class="btn-store more-mt"><a id="contact_store" href="javascript:void(0)">保存</a></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="prev_cover" class="my-cover-bg" style="display:none;"></div>
            <div id="prev_phone" class="abs-center abs-center-bg" style="display:none;">
               <img class="state" src="images/defbd-top.jpg" alt="手机信号栏">
               <div id="phone_show" class="defbd-left phone-show"></div>
               <div class="exit-btn">
                   <a id="exit_prew" href="javascript:void(0)">退出预览</a>
               </div>
            </div>
            <div id="suc_pub_info" class="my-pub-wrapper" style="display:none;">
              <div class="my-sucs-pub-info my-text-center my-boder-radius">
                <img src="images/publish-ok.png" alt="正确图标" />&nbsp;&nbsp;发布成功
              </div>
            </div>
            <script>
                ;(function() {
                    var initInfo = {
                        banner : {
                            bannerBg : "images/def-bg2.jpg",
                            teamLogo :"images/team-icon.png",
                            teamName :"宜和",
                            teamIntro : "儿科",
                        },
                        /*doctor : [0,1],
                        essay : [1],*/
                        sltDoctor : [0,1],
                        sltEssay : [1],
                        rmnDoctor : [2,1,0,1,2,0],
                        rmnEssay : [0],
                        contact : {
                            code : "images/for-scan.png",
                            addr : "mm",
                            phone : "13455667788",
                        }
                    };
                    var doctors = [{
                            id : "0",
                            img : "images/article-img.jpg",
                            name : "裴医生",
                            career : "原深圳市儿童医院副主任",
                            study : "儿科硕士",
                            tag : ["喉软化","喉软化","扁桃体炎"],
                        },{
                            id : "1",
                            img : "images/article-img.jpg",
                            name : "生",
                            career : "医院副主任",
                            study : "儿科硕士",
                            tag : ["喉软化","喉软化","扁桃体炎"],
                        },{
                            id : "2",
                            img : "images/article-img.jpg",
                            name : "生医院",
                            career : "医院副主任",
                            study : "儿科硕士",
                            tag : ["喉软化","喉软化","扁桃体炎"],
                        }
                    ];
                    var essays = [{
                        id : "0",
                        img : "images/article-img.jpg",
                        title : "裴医生",
                        content : "原深圳市儿童医院副主任原深圳市儿童医院原深圳市儿童医院原深圳市儿童医院原深圳市儿童医院原深圳市儿童医院原深圳市儿童医院",
                    },{
                        id : "1",
                        img : "images/article-img.jpg",
                        title : "原深圳市儿童医院",
                        content : "原深圳市儿童医院原深圳市儿童医院原深圳市儿童医院原深圳市儿童医院原深圳市儿童医院原深圳市儿童医院原深圳市儿童医院原深圳市儿童医院原深圳市儿童医院原深圳市儿童医院原深圳市儿童医院原深圳市儿童医院",
                    },{
                        id : "2",
                        img : "images/article-img.jpg",
                        title : "儿童医院",
                        content : "原深圳市儿童医院原深圳市儿童医院原深圳市儿童医院",
                    }];

                    var util = {
                        rightSeg : [$("#team_edit"),$("#doctor_edit"),$("#essay_edit"),$("#contact_edit")],
                        idName : ["#teamInfo_prvw","#teamDct_prvw","#teamEsy_prvw","#teamCtat_prvw"],
                        leftSeg : [$("#teamDct_prvw"),$("#teamEsy_prvw"),$("#teamCtat_prvw")],
                        segTitle : ["医生","文章","联系方式"],
                        setLeft : ["选择医生","选择文章","选择联系方式"],
                        ulId : ["doctor_prev","essay_prev","contact_prev"],
                        dctAndEsy : [{all:$("#all_doctors"),slctd:$("#sltd_doctors"),scount:$("#sltd_doctors_count"),acount:$("#all_doctors_count")},{all:$("#all_essay"),slctd:$("#sltd_essay"),scount:$("#sltd_essay_count"),acount:$("#all_essay_count")}],
                        codeRecord : $("#code_record"),
                        // count : [4,2], //医生与文章总数
                        teamPara : {}, //存团队信息
                        teamDctr : [],//选中的医生的编号
                        teamEsy : [],//选中的文章的编号
                        teamCntat : {},//联系信息
                        isEdit : [true,true,true,true],//表示对应的四部分是否编辑过，确定预览时是否需要显示出来
                    };
                   
                    //各操作函数
                    var fn = {
                        //获取被选中的医生/文章的id
                        getSlctDE : function(obj) {
                            var res = [];
                            for (var i = 0; i < obj.length; i++) {
                                res.push(obj.eq(i).attr("value"));
                            }
                            return res;
                        },
                        //判断各部分的标题是否存在
                        titleExist : function(index) {
                            // console.log(len > 0 ? true:false);
                            return util.leftSeg[index].find(".prew-title").length > 0 ? true:false;
                        },
                        //添加包裹自定义信息的容器
                        addWrp :function(index,count) {
                            var inner = '<div class="prew-title"><h4><span class="left"></span>'+util.segTitle[index];
                            if(count) {
                                inner += '<span class="defbd-aglr">&nbsp;&nbsp;</span>&nbsp;&nbsp;<span id="'+util.ulId[index]+'_count" class="count">'+count+'</span></h4></div><div class="prew-ul"><ul id='+util.ulId[index]+'></ul></div>';
                            }
                            else {
                                inner += '</div><div id="contact_prev" class="prew-pd"></div>';
                            }
                            util.leftSeg[index].html(inner);
                        },
                        addDoctor : function(dctrIdArr) {
                            var tgt = $("#"+util.ulId[0]),dctCount = dctrIdArr.length;
                            tgt.html("");
                            $("#"+util.ulId[0]+"_count").html(dctCount);
                            for (var i = 0,len = dctCount; i < len; i++) {
                                var doctor = doctors[dctrIdArr[i]];
                                var info = ['<li><img class="left" alt="医生头像" src="',doctor.img,'"><div class="detail"><h3>',doctor.name,'</h3><h4>',doctor.career,'</h4><p>',doctor.study,'</p><dl class="tag">'];
                                for (var j = 0,len1 = doctor.tag.length>3?3:doctor.tag.length; j < len1; j++) {
                                    info.push("<dt>"+doctor.tag[j]+"</dt>");
                                }
                                info.push('</dl></div></li>');
                                tgt.append($(info.join('')));
                            }
                        },
                        //添加文章列表
                        addEssay : function(esyIdArr) {
                            var tgt = $("#"+util.ulId[1]),esyCount = esyIdArr.length;
                            tgt.html("");
                            $("#"+util.ulId[1]+"_count").html(esyCount);
                            for (var i = 0,len = esyCount; i < len; i++) {
                                var essay = essays[esyIdArr[i]];
                                var info = ['<li><img class="left" alt="文章缩略图" src="',essay.img,'"><div class="detail"><h4 class="trunc-text">',essay.title,'</h4><p  class="artcl">'];
                                if(essay.content.length > 34) {
                                    info.push(essay.content.substr(0,35)+"...");
                                }
                                else {
                                    info.push(essay.content);
                                }
                                info.push('</p>','</dl></div></li>');
                                tgt.append($(info.join('')));
                            }
                        },
                        //添加联系方式
                        addCtat :function(ctctObj) {
                            var info = [],tgt = $("#"+util.ulId[2]);
                            tgt.html("");
                            if(ctctObj.code) {
                                info.push('<div class="prew-code"><img alt="医疗团队二维码" src='+ctctObj.code+'></div><p class="prew-toscan">长按识别关注我们</p>');
                            }
                            if(ctctObj.addr) {
                               info.push('<p class="prew-addr">地址:'+ctctObj.addr+"</p>"); 
                            }
                            if(ctctObj.phone) {
                                info.push('<p class="prew-phone">电话:'+ctctObj.phone+'</p>');
                            }
                            tgt.append($(info.join('')));
                        },
                        //添加 +选择文章、医生等的视图
                        addEdit : function(index) {
                            var html = '<a class="add" href="javascript:void(0);"><div class="addwrp"><h3><span class="add-icon">+</span>'+util.setLeft[index]+'</h3></div></a>';
                            util.leftSeg[index].html(html);
                            // ele.show().next().hide();
                        },
                        //创建医生列表
                        /*createDoctor : function(doctor) {
                            var html = ['<li value="',doctor.id,'"><img class="left" src="',doctor.img,'" alt="医生头像"><div class="detail"><h3>',doctor.name,'</h3><h4 class="trunc-text">',doctor.career,'</h4><p class="trunc-text">',doctor.study,'</p></div><div class="hdl-btn-wrp"><i class="delete"><a href="javascript:void(0);">删除</a></i><i class="one-up"><a href="javascript:void(0);">上移</a></i><i class="one-down"><a href="javascript:void(0);">下移</a></i></div><div class="hdl-btn-addw"><i class="tomain"><a href="javascript:void(0);">主页</a></i><i class="add"><a href="javascript:void(0);">添加</a></i></div></li>'];
                            return html.join("");
                        },*/
                        createDoctor : function(dctrIdArr,count) {
                            var html = [];
                            for (var i = 0; i < count; i++) {
                                var doctor = doctors[dctrIdArr[i]];
                                html.push('<li value="',doctor.id,'"><img class="left" src="',doctor.img,'" alt="医生头像"><div class="detail"><h3>',doctor.name,'</h3><h4 class="trunc-text">',doctor.career,'</h4><p class="trunc-text">',doctor.study,'</p></div><div class="hdl-btn-wrp"><i class="delete"><a href="javascript:void(0);">删除</a></i><i class="one-up"><a href="javascript:void(0);">上移</a></i><i class="one-down"><a href="javascript:void(0);">下移</a></i></div><div class="hdl-btn-addw"><i class="tomain"><a href="javascript:void(0);">主页</a></i><i class="add"><a href="javascript:void(0);">添加</a></i></div></li>');
                            }
                            return html.join("");
                        },
                        //创建医生列表
                        createEssay : function(esyIdArr,count) {
                            var html = [];
                            for (var i = 0; i < count; i++) {
                                var essay = essays[esyIdArr[i]];
                                html.push('<li value="',essay.id,'"><img class="left" src="',essay.img,'" alt="文章头像"><div class="detail"><h4 class="trunc-text">',essay.title,'</h4><p class="trunc-text">',essay.content,'</p></div><div class="hdl-btn-wrp"><i class="delete"><a href="javascript:void(0);">删除</a></i><i class="one-up"><a href="javascript:void(0);">上移</a></i><i class="one-down"><a href="javascript:void(0);">下移</a></i></div><div class="hdl-btn-addw"><i class="tomain"><a href="javascript:void(0);">主页</a></i><i class="add"><a href="javascript:void(0);">添加</a></i></div></li>');
                            }
                            return html.join("");
                        }
                    };
                    //事件处理函数
                    var hdlr = {
                        //右边显示哪部分
                        rbDisplay : function(ele) {
                            ele.show().siblings().not(":first-child").hide();
                        },
                        //teamBanner的展示
                        tbDisplay : function(bnInfo) {
                            var bg = $("#teambg_prvw"),contentWrp = $("#teamcnt_prvw");
                            if(bnInfo.bannerBg) {
                                bg.attr("src",bnInfo.bannerBg).css("display","block").next().css("color","#fff");
                                util.isEdit[0] = true;
                            }
                            if(bnInfo.teamLogo) {
                                contentWrp.find("img").attr("src",bnInfo.teamLogo);
                                util.isEdit[0] = true;
                            }
                            else {
                                contentWrp.find("img").attr("src","images/team-icon.png");
                            }
                            if(bnInfo.teamName) {
                                contentWrp.find("#team_name").html(bnInfo.teamName);
                                util.isEdit[0] = true;
                            }
                            else {
                               contentWrp.find("#team_name").html("团队名称");
                            }
                            if(bnInfo.teamIntro) {
                                var words = bnInfo.teamIntro;
                                if(words.length > 44) {
                                    $("#team_intro").html(words.substr(0,42)+"...").css("text-align","left").parent().next().show();
                                }
                                else {
                                    var setwords = $("#team_intro").html(words);
                                    if(words.length > 26) {
                                        setwords.css("text-align","left");
                                    }
                                    else {
                                        setwords.css("text-align","center");
                                    }
                                    setwords.parent().next().hide();
                                }
                                util.isEdit[0] = true;
                            }
                            else {
                                $("#team_intro").html("团队介绍").css("text-align","center").parent().next().hide();
                            }
                        },
                        //teamDoctor的显示
                        tdDisplay : function(dctrIdArr) {
                            if(!fn.titleExist(0)) {
                                fn.addWrp(0,dctrIdArr.length);
                            }
                            fn.addDoctor(dctrIdArr);
                        },
                        //teamEssay的显示
                        teDisplay : function(esyIdArr) {
                            if(!fn.titleExist(1)) {
                                fn.addWrp(1,esyIdArr.length);
                            }
                            fn.addEssay(esyIdArr);
                        },
                        //teamContact的显示
                        tcDisplay : function(ctctObj) {
                            if(!fn.titleExist(2)) {
                                fn.addWrp(2);
                            }
                            fn.addCtat(ctctObj);
                        },
                        // 拖动结束后更新文章、医生数量,dctOrEsy:0医生。1文章;addCnt:选中文本增加的数量
                        countHlr : function(dctOrEsy,addCnt) {
                            var ele = util.dctAndEsy[dctOrEsy],oldCounts = 1*ele.scount.html(),oldCounta = 1*ele.acount.html();
                            ele.scount.html(oldCounts+addCnt);
                            ele.acount.html(oldCounta-addCnt);
                        },
                        //医生/文章列表图标点击事件处理,dctOrEsy为0表示医生，1表示文章
                        changePlace : function(dctOrEsy,trgt) {
                            var tagName = trgt.tagName,obj = util.dctAndEsy[dctOrEsy];
                            if(tagName === "A") {
                                var li = $(trgt).parent().parent().parent(),prev = li.prev(),next = li.next();
                                switch($(trgt).html()) {
                                    case "删除":
                                        li.appendTo(obj.all);
                                        hdlr.countHlr(dctOrEsy,-1);
                                        break;
                                    case "添加":
                                        li.appendTo(obj.slctd);
                                        hdlr.countHlr(dctOrEsy,1);
                                        break;
                                    case "主页":
                                        /*跳转到医生主页
                                        li.appendTo(obj.slctd);
                                        hdlr.countHlr(dctOrEsy,1);*/
                                        break;
                                    case "上移":
                                        li.insertBefore(prev);
                                        break;
                                    case "下移":
                                        li.insertAfter(next);
                                        break;
                                    default:
                                        break;
                                }
                            }
                            else if(tagName === "H3" || tagName === "H4" || tagName === "P" || tagName === "LI") {
                                //跳转到医生/文章主页,未写处理函数
                            }
                        },
                        //之前有选表目，现在不选了
                        segHide : function(index) {
                            var add = util.leftSeg[index].find(".add");
                            if(add.length === 0) {
                                fn.addEdit(index);
                            }
                        },
                        //在首次进入时，dctrIdArr医生显示
                        dplDctr : function(dctrIdArr,htmlWrp,countWrp) {
                            var doctor = "",html = "";
                            htmlWrp.html(fn.createDoctor(dctrIdArr,dctrIdArr.length));
                            countWrp.html(dctrIdArr.length);
                        },
                        //在首次进入时，选中的医生显示
                        dplEsy : function(esyIdArr,htmlWrp,countWrp) {
                            var essay = "",html = "";
                            htmlWrp.html(fn.createEssay(esyIdArr,esyIdArr.length));
                            countWrp.html(esyIdArr.length);
                        },
                    };
                    //事件添加
                    var eventAdd = function() {
                        //左边团队介绍字数过多时展开关闭
                        $("#ov_rotate").on("click",function(e) {
                            $(this).toggleClass("rotate-half").parent().prev().toggleClass("intro-wrp");
                            if(this.className !== "defbd-aglt") {
                                $("#team_intro").html(util.teamPara.teamIntro);
                            }
                            else {
                                $("#team_intro").html(util.teamPara.teamIntro.substr(0,42)+"...");
                            }
                        });
                        //点击左边切换右边视图
                        $("#preview_team").on("click","li",function(e) {
                            var trgt = $(this).index();
                            hdlr.rbDisplay(util.rightSeg[trgt]);
                            if($(this).attr("id") === "teamInfo_prvw") {
                                $(this).find("#teambg_prvw").next().addClass("shadow").end().end().siblings().removeClass("active");
                                return;
                            }
                            else {
                                $("#teambg_prvw").next().removeClass("shadow");
                            }
                            if($(this).parent().attr("id") === "preview_team") {
                                $(this).addClass("active").siblings().removeClass("active");
                            }
                        });
                        //背景选择
                        $("#bg_choose").on("click","li",function(e) {
                            var that = $(this).find('img');
                            that.next().css("opacity","1");
                            that.end().siblings().find("div").css("opacity","0");
                            util.teamPara.bannerBg = that.attr("src");
                        });
                        //输入团队介绍文字的控制
                        $("#in_team_intro").on("input",function() {
                            var value = this.value,len = 200-value.length;
                            if(len >= 0) {
                                $(this).parent().next().html("还能输入"+len+"字");/*
                                $("#team_intro").html(value);*/
                            }
                            else {
                                $(this).parent().next().html("还能输入0字");
                                $(this).val(value.slice(0,200));
                            }
                        })
                        //保存按键
                        $(".btn-store").on("click","a",function(e) {
                            switch(e.target.id) {
                                case "team_store":
                                    util.teamPara.teamLogo = $("#team_logo").val();
                                    util.teamPara.teamName = $("#in_team_name").val().trim();
                                    util.teamPara.teamIntro = $("#in_team_intro").val().trim();
                                    hdlr.tbDisplay(util.teamPara);
                                    break;
                                case "doctor_store":
                                    util.teamDctr = fn.getSlctDE($("#sltd_doctors li"));
                                    if(util.teamDctr.length) {
                                        util.isEdit[1] = true;
                                        hdlr.tdDisplay(util.teamDctr);
                                    }
                                    else {
                                        hdlr.segHide(0);
                                        util.isEdit[1] = false;
                                    }
                                    break;
                                case "essay_store":
                                    util.teamEsy = fn.getSlctDE($("#sltd_essay li"));
                                    if(util.teamEsy.length) {
                                        util.isEdit[2] = true;
                                        hdlr.teDisplay(util.teamEsy);
                                    }
                                    else {
                                        hdlr.segHide(1);
                                        util.isEdit[2] = false;
                                    }
                                    break;
                                case "contact_store":
                                    util.teamCntat.addr = $("#contact_addr").val();
                                    util.teamCntat.phone = $("#contact_phone").val();
                                    if($("#contact_code:checked").length) {
                                        util.teamCntat.code = $("#contact_code:checked").next().find("img").attr("src");
                                    }
                                    else {
                                        util.teamCntat.code = "";
                                    }
                                    if(util.teamCntat.addr || util.teamCntat.phone || util.teamCntat.code) {
                                        util.isEdit[3] = true;
                                        hdlr.tcDisplay(util.teamCntat);
                                    }
                                    else {
                                        hdlr.segHide(2);
                                        util.isEdit[3] = false;
                                    }
                                    break;
                                default :
                                    break;
                            };
                        });
                        //医生列表
                        $( "#sltd_doctors, #all_doctors").sortable({
                            connectWith: ".ul-dct",
                            receive : function(e) {
                                e.target.id === "sltd_doctors" ? hdlr.countHlr(0,1):hdlr.countHlr(0,-1);
                            }
                        }).disableSelection().on({
                            click : function(e) {
                                hdlr.changePlace(0,e.target);
                            }
                        });

                        var getTop = function(ele) {
                            var actualTop = ele.offsetTop,current = ele.offsetParent;
                            while (!current) {
                                actualTop += current.offsetTop;
                                current = current.offsetParent;
                            }
                            return actualTop;
                        };

                        $( "#all_doctors").on("click","li",function(e) {
                            console.log(getTop(e.target));
                        });
                      /*  $("#all_doctors").sortable({
                            // disabled : true,
                        });*/
                        //文章列表
                        $( "#sltd_essay, #all_essay" ).sortable({
                          connectWith: ".ul-esy",
                          receive : function(e) {
                                e.target.id === "sltd_essay" ? hdlr.countHlr(1,1):hdlr.countHlr(1,-1);
                            }
                        }).disableSelection().on("click",function(e) {
                            hdlr.changePlace(1,e.target);
                        });
                        //预览/发布按键
                        $("#pub_prew").on("click","a",function(e) {
                            if($(this).html() === "预览") {
                                var jq = $("#preview_team").clone().find("li.active").removeClass("active").end().find("#teamcnt_prvw").removeClass("shadow").end();
                                for (var i = 0; i < 4; i++) {
                                    if(!util.isEdit[i]) {
                                        jq.find(util.idName[i]).remove();
                                    }
                                    else {
                                        jq.find(util.idName[i]).css("border","none");
                                    }
                                }
                                var showEle = $("#phone_show").html("<ul>"+jq.html()+"</ul>").parent();
                                showEle.prev().add(showEle).show();
                            }
                            else {
                                $("#suc_pub_info").show().delay(2000).fadeOut('slow');
                                window.location.href = "def-edit.html";
                            }
                        });
                        //公众号二维码
                        $("#add_code").on("click",function(e) {
                            if(e.target.tagName === "INPUT") {
                                util.codeRecord.toggleClass("selected");
                            }
                        });
                        //关闭预览处理
                        $("#prev_cover,#exit_prew").on("click",function(e) {
                            var tgt = $(e.target);
                            if(tgt.attr("class") === "my-cover-bg") {
                                tgt.hide().next().hide();
                            }
                            else {
                               tgt.parent().parent().hide().prev().hide();
                            }
                        });
                        $("#go_index").on("click",function(e) {
                            window.location.href = "def-idx.html";
                        });
                    };
                    eventAdd();
                    //初始化函数,页面加载时看之前是否已经编辑过信息
                    var init = function(info) {
                        if (util.isEdit[0]) {
                            hdlr.tbDisplay(info.banner);
                        }
                        if(util.isEdit[1]) {
                            hdlr.tdDisplay(info.sltDoctor);
                            hdlr.dplDctr(info.sltDoctor,util.dctAndEsy[0].slctd,util.dctAndEsy[0].scount);
                            hdlr.dplDctr(info.rmnDoctor,util.dctAndEsy[0].all,util.dctAndEsy[0].acount);
                        }
                        if(util.isEdit[2]) {
                            hdlr.teDisplay(info.sltEssay);
                            hdlr.dplEsy(info.sltEssay,util.dctAndEsy[1].slctd,util.dctAndEsy[1].scount);
                            hdlr.dplEsy(info.rmnEssay,util.dctAndEsy[1].all,util.dctAndEsy[1].acount);
                        }
                        if(util.isEdit[3]) {
                            hdlr.tcDisplay(info.contact);
                        }
                    };
                    init(initInfo);
                })();
            </script>

            <!-- layout footer -->
            <div class="footer">
                <div class="footer-content">
                    <div class="copyright">
                        <p>© 1998 - 2016 Tencent All Right Reserved.</p>
                    </div>

                    <div class="links">
                        <ul>
                            <li><a href="javascript:void(0)">关于我们</a></li>
                            <li><a href="javascript:void(0)">隐私保护</a></li>
                            <li><a href="javascript:void(0)">服务条款</a></li>
                            <li class="last"><a href="javascript:void(0)">客服中心</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
        	var _layout_user_info = "http://doctor.qq.com/mp/admin/Dashboard/getUser";
        	var _heartbeat = "http://doctor.qq.com/mp/admin/Heartbeat/one?ajax=1";;
        	var NP = NP || "default_layout_np";
        </script>
        <script type="text/javascript" src="http://doctor.qq.com/mp/public/admin/scripts/admin.js?t=1"></script>
<script>
(function(){
    if(window.doctor){
        return;
    };

    var doctor={};
    doctor.count=function(){if (typeof(pgvMain) == 'function') pgvMain()};
    doctor.loadScript=function(url,callback){
        var script = document.createElement('script');
        script.type = "text/javascript";
        if (script.readyState) {
            script.onreadystatechange = function() {
                if (script.readyState == "loaded" || script.readyState == "complete") {
                    script.onreadystatechange = null;
                    if (callback) {
                        callback()
                    }
                }
            }
        } else {
            script.onload = function() {
                if (callback) {
                    callback()
                }
            }
        }
        script.src = url;
        document.body.appendChild(script)
    };

    doctor.init=function(){
        doctor.loadScript('http://tajs.qq.com/stats?sId=55876264',function() {
            doctor.loadScript('http://pingjs.qq.com/tcss.ping.js',function(){doctor.count()});
        });
    };

    window.doctor=doctor;
    doctor.init();
})();
</script>